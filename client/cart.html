<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart - TechPharma</title>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f1f3f6;
            min-height: 100vh;
        }

        .top-bar {
            background: #2874f0;
            padding: 12px 0;
            box-shadow: 0 1px 1px 0 rgba(0,0,0,.1);
        }

        .top-bar-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo {
            color: white;
            font-size: 24px;
            font-weight: 700;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .breadcrumb {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
        }

        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: 1fr 360px;
            gap: 20px;
            align-items: start;
        }

        @media (max-width: 968px) {
            .container {
                grid-template-columns: 1fr;
            }
        }

        .loading {
            text-align: center;
            padding: 60px 20px;
            background: white;
            border-radius: 2px;
            box-shadow: 0 1px 2px 0 rgba(0,0,0,.1);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2874f0;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .alert {
            padding: 12px 16px;
            border-radius: 2px;
            margin-bottom: 16px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .alert-error {
            background: #fff4f4;
            color: #c92a2a;
            border: 1px solid #ffc9c9;
        }

        .alert-success {
            background: #f4fcf4;
            color: #2b8a3e;
            border: 1px solid #b2f2bb;
        }

        .main-content {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .card {
            background: white;
            border-radius: 2px;
            box-shadow: 0 1px 2px 0 rgba(0,0,0,.1);
        }

        .card-header {
            padding: 16px 20px;
            border-bottom: 1px solid #f0f0f0;
        }

        .card-title {
            font-size: 18px;
            font-weight: 500;
            color: #212121;
        }

        .card-body {
            padding: 20px;
        }

        .empty-cart {
            text-align: center;
            padding: 80px 20px;
        }

        .empty-cart-icon {
            font-size: 100px;
            opacity: 0.3;
            margin-bottom: 20px;
        }

        .empty-cart h2 {
            font-size: 18px;
            font-weight: 500;
            color: #212121;
            margin-bottom: 8px;
        }

        .empty-cart p {
            color: #878787;
            font-size: 14px;
        }

        .cart-item {
            display: flex;
            gap: 16px;
            padding: 20px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .item-image {
            width: 112px;
            height: 112px;
            background: #f8f8f8;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            flex-shrink: 0;
        }

        .item-details {
            flex: 1;
            min-width: 0;
        }

        .item-name {
            font-size: 16px;
            font-weight: 500;
            color: #212121;
            margin-bottom: 6px;
            line-height: 1.4;
        }

        .item-content {
            color: #878787;
            font-size: 14px;
            margin-bottom: 8px;
        }

        .item-meta-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 12px 0;
        }

        .meta-tag {
            background: #f8f8f8;
            padding: 4px 10px;
            border-radius: 2px;
            font-size: 12px;
            color: #878787;
        }

        .meta-tag strong {
            color: #212121;
        }

        .prescription-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 8px;
            border-radius: 2px;
            font-size: 12px;
            font-weight: 500;
        }

        .badge-required {
            background: #fff4f4;
            color: #c92a2a;
        }

        .badge-not-required {
            background: #f4fcf4;
            color: #2b8a3e;
        }

        .item-controls {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 12px;
        }

        .item-price {
            font-size: 20px;
            font-weight: 500;
            color: #212121;
        }

        .quantity-control {
            display: flex;
            align-items: center;
            border: 1px solid #c2c2c2;
            border-radius: 2px;
            overflow: hidden;
        }

        .qty-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: white;
            color: #878787;
            cursor: pointer;
            font-size: 18px;
            font-weight: 600;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .qty-btn:hover:not(:disabled) {
            background: #f8f8f8;
            color: #2874f0;
        }

        .qty-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .qty-display {
            width: 40px;
            text-align: center;
            font-weight: 600;
            color: #212121;
            border-left: 1px solid #c2c2c2;
            border-right: 1px solid #c2c2c2;
            font-size: 14px;
        }

        .remove-btn {
            background: none;
            border: none;
            color: #878787;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            padding: 8px;
            transition: color 0.2s;
        }

        .remove-btn:hover:not(:disabled) {
            color: #c92a2a;
        }

        .remove-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .sidebar {
            position: sticky;
            top: 20px;
        }

        .price-details {
            background: white;
            border-radius: 2px;
            box-shadow: 0 1px 2px 0 rgba(0,0,0,.1);
        }

        .price-header {
            padding: 16px 20px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 16px;
            font-weight: 500;
            color: #878787;
            text-transform: uppercase;
        }

        .price-body {
            padding: 20px;
        }

        .price-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 16px;
            font-size: 16px;
            color: #212121;
        }

        .price-row.total {
            padding-top: 16px;
            border-top: 1px dashed #e0e0e0;
            font-weight: 600;
            font-size: 18px;
        }

        .savings {
            color: #388e3c;
            font-weight: 500;
        }

        .delivery-form {
            background: white;
            border-radius: 2px;
            box-shadow: 0 1px 2px 0 rgba(0,0,0,.1);
        }

        .form-section {
            padding: 20px;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group:last-child {
            margin-bottom: 0;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 500;
            color: #212121;
        }

        .form-input {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid #c2c2c2;
            border-radius: 2px;
            font-size: 14px;
            color: #212121;
            transition: border-color 0.2s;
            font-family: inherit;
        }

        .form-input:focus {
            outline: none;
            border-color: #2874f0;
        }

        .form-input::placeholder {
            color: #878787;
        }

        textarea.form-input {
            resize: vertical;
            min-height: 80px;
        }

        .checkout-btn {
            width: 100%;
            padding: 16px;
            background: #fb641b;
            color: white;
            border: none;
            border-radius: 2px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 1px 2px 0 rgba(0,0,0,.2);
            margin-top: 20px;
        }

        .checkout-btn:hover:not(:disabled) {
            background: #e85c0d;
        }

        .checkout-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-loader {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 8px;
            vertical-align: middle;
        }

        .payment-success {
            text-align: center;
            padding: 60px 40px;
        }

        .success-icon {
            width: 80px;
            height: 80px;
            background: #f4fcf4;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
            font-size: 40px;
        }

        .success-title {
            font-size: 24px;
            font-weight: 500;
            color: #212121;
            margin-bottom: 8px;
        }

        .success-message {
            color: #878787;
            font-size: 14px;
            margin-bottom: 32px;
        }

        .payment-info {
            background: #f8f8f8;
            border-radius: 2px;
            padding: 20px;
            margin-bottom: 24px;
            text-align: left;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            font-size: 14px;
        }

        .info-label {
            color: #878787;
        }

        .info-value {
            color: #212121;
            font-weight: 500;
            word-break: break-all;
        }

        .continue-btn {
            width: 100%;
            padding: 16px;
            background: #2874f0;
            color: white;
            border: none;
            border-radius: 2px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .continue-btn:hover {
            background: #1c5ec4;
        }

        .secure-badge {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            padding: 12px;
            background: #f8f8f8;
            border-radius: 2px;
            margin-top: 16px;
            font-size: 12px;
            color: #878787;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            color: #2874f0;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 16px;
            padding: 8px 0;
            transition: gap 0.2s;
        }

        .back-link:hover {
            gap: 10px;
        }
    </style>
</head>
<body>
    <div class="top-bar">
        <div class="top-bar-content">
            <a href="index.html" class="logo">
                <span>üíä</span>
                <span>TechPharma</span>
            </a>
            <span class="breadcrumb">Shopping Cart</span>
        </div>
    </div>

    <div id="alertContainer"></div>
    <div id="mainContainer"></div>

    <script>
        const API_BASE_URL = 'http://localhost:8080/api';
        const VIEW_CART_URL = `${API_BASE_URL}/user/view-cart`;
        const UPDATE_CART_URL = `${API_BASE_URL}/user/update-cart`;
        const CREATE_ORDER_URL = `${API_BASE_URL}/payment/create-order`;
        const VERIFY_PAYMENT_URL = `${API_BASE_URL}/payment/verify`;
        const AUTH_TOKEN = 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiYzhiM2MyMmMtY2JjOC00YmU0LWE1MzQtM2UwMzZkYjQxZGM5IiwiZW1haWwiOiJqb2huLmRvZUBleGFtcGxlLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiZmlyc3RfbmFtZSI6IkpvaG4iLCJsYXN0X25hbWUiOiJEb2UiLCJsYXRpdHVkZSI6MCwibG9uZ2l0dWRlIjowLCJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiaXNzIjoidGVjaHBoYXJtYSIsInN1YiI6ImM4YjNjMjJjLWNiYzgtNGJlNC1hNTM0LTNlMDM2ZGI0MWRjOSIsImV4cCI6MTc2MTEzMjMyMSwibmJmIjoxNzYxMDQ1OTIxLCJpYXQiOjE3NjEwNDU5MjEsImp0aSI6IjA3NGMxNWRhLWQ5YzctNDAwNS05Y2QwLTM2NjU3YjlmZWFkZSJ9.s678A0_S6koeU8f6O2K7EGXmrYMOklhgBJ3tvawLD5A';

        const alertContainer = document.getElementById('alertContainer');
        const mainContainer = document.getElementById('mainContainer');
        let cartData = null;
        let isUpdating = false;
        let isProcessingPayment = false;

        async function loadCart() {
            try {
                showLoading();
                clearAlerts();
                const response = await fetch(VIEW_CART_URL, {
                    method: 'GET',
                    headers: { 'Authorization': AUTH_TOKEN }
                });
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const data = await response.json();
                if (data.success && data.data) {
                    cartData = data.data;
                    displayCart(cartData);
                } else {
                    showEmptyCart();
                }
            } catch (error) {
                showAlert(`Failed to load cart: ${error.message}`, 'error');
                showEmptyCart();
            }
        }

        function displayCart(cart) {
            const validItems = cart.medicines.filter(item => item.medicine.id !== "00000000-0000-0000-0000-000000000000");
            if (validItems.length === 0) {
                showEmptyCart();
                return;
            }
            const totalItems = validItems.reduce((sum, item) => sum + item.quantity, 0);
            const totalAmount = cart.total_amount;
            const itemsHTML = validItems.map(item => {
                const med = item.medicine;
                const itemTotal = med.price * item.quantity;
                return `
                    <div class="cart-item">
                        <div class="item-image">üíä</div>
                        <div class="item-details">
                            <div class="item-name">${med.name}</div>
                            ${med.content ? `<div class="item-content">${med.content}</div>` : ''}
                            ${med.description ? `<div class="item-content">${med.description}</div>` : ''}
                            <div class="item-meta-tags">
                                ${med.manufacturer ? `<span class="meta-tag"><strong>Mfr:</strong> ${med.manufacturer}</span>` : ''}
                                ${med.batchNumber ? `<span class="meta-tag"><strong>Batch:</strong> ${med.batchNumber}</span>` : ''}
                                ${med.expiryDate ? `<span class="meta-tag"><strong>Exp:</strong> ${formatDate(med.expiryDate)}</span>` : ''}
                            </div>
                            <span class="prescription-badge ${med.prescriptionRequired ? 'badge-required' : 'badge-not-required'}">
                                ${med.prescriptionRequired ? '‚öïÔ∏è Prescription Required' : '‚úì No Prescription Needed'}
                            </span>
                        </div>
                        <div class="item-controls">
                            <div class="item-price">‚Çπ${itemTotal.toFixed(2)}</div>
                            <div class="quantity-control">
                                <button class="qty-btn" onclick="updateQuantity('${item.medicine_id}', ${item.quantity - 1})" ${isUpdating ? 'disabled' : ''}>‚àí</button>
                                <span class="qty-display">${item.quantity}</span>
                                <button class="qty-btn" onclick="updateQuantity('${item.medicine_id}', ${item.quantity + 1})" ${isUpdating ? 'disabled' : ''}>+</button>
                            </div>
                            <button class="remove-btn" onclick="removeItem('${item.medicine_id}')" ${isUpdating ? 'disabled' : ''}>REMOVE</button>
                        </div>
                    </div>
                `;
            }).join('');
            mainContainer.innerHTML = `
                <div class="container">
                    <div class="main-content">
                        <a href="index.html" class="back-link">‚Üê Continue Shopping</a>
                        <div class="card">
                            <div class="card-header"><div class="card-title">My Cart (${totalItems} ${totalItems === 1 ? 'item' : 'items'})</div></div>
                            <div class="card-body">${itemsHTML}</div>
                        </div>
                        <div class="delivery-form">
                            <div class="card-header"><div class="card-title">Delivery Information</div></div>
                            <div class="form-section">
                                <div class="form-group">
                                    <label class="form-label" for="customerName">Full Name *</label>
                                    <input type="text" id="customerName" class="form-input" value="John Doe" placeholder="Enter your full name" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="customerPhone">Phone Number *</label>
                                    <input type="tel" id="customerPhone" class="form-input" value="+919876543210" placeholder="Enter your 10 digit mobile number" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="customerEmail">Email Address *</label>
                                    <input type="email" id="customerEmail" class="form-input" value="john.doe@example.com" placeholder="Enter your email" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="deliveryAddress">Delivery Address *</label>
                                    <textarea id="deliveryAddress" class="form-input" placeholder="Enter complete address with pincode" required>123 Main Street, Apartment 4B, Mumbai, Maharashtra 400001</textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sidebar">
                        <div class="price-details">
                            <div class="price-header">Price Details</div>
                            <div class="price-body">
                                <div class="price-row"><span>Price (${totalItems} ${totalItems === 1 ? 'item' : 'items'})</span><span>‚Çπ${totalAmount.toFixed(2)}</span></div>
                                <div class="price-row"><span>Delivery Charges</span><span class="savings">FREE</span></div>
                                <div class="price-row total"><span>Total Amount</span><span>‚Çπ${totalAmount.toFixed(2)}</span></div>
                                <button class="checkout-btn" onclick="proceedToPayment()" id="checkoutBtn">PLACE ORDER</button>
                                <div class="secure-badge"><span>üîí</span><span>Secure Payments by Razorpay</span></div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function showEmptyCart() {
            mainContainer.innerHTML = `
                <div class="container" style="grid-template-columns: 1fr;">
                    <div class="card">
                        <div class="empty-cart">
                            <div class="empty-cart-icon">üõí</div>
                            <h2>Your cart is empty!</h2>
                            <p>Add items to it now</p>
                            <button class="checkout-btn" onclick="window.location.href='index.html'" style="max-width: 250px; margin: 24px auto 0;">Shop Now</button>
                        </div>
                    </div>
                </div>
            `;
        }

        async function updateQuantity(medicineId, newQuantity) {
            if (isUpdating || newQuantity < 0) return;
            if (newQuantity === 0) { removeItem(medicineId); return; }
            try {
                isUpdating = true;
                disableButtons();
                const response = await fetch(UPDATE_CART_URL, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json', 'Authorization': AUTH_TOKEN },
                    body: JSON.stringify({ medicine_id: medicineId, quantity: newQuantity })
                });
                const data = await response.json();
                if (!response.ok) throw new Error(data.message || 'Failed to update quantity');
                if (data.success) {
                    await loadCart();
                    showAlert('Cart updated successfully!', 'success');
                } else throw new Error(data.message || 'Failed to update cart');
            } catch (error) {
                showAlert(`Failed to update cart: ${error.message}`, 'error');
            } finally {
                isUpdating = false;
            }
        }

        async function removeItem(medicineId) {
            if (isUpdating || !confirm('Remove item from cart?')) return;
            try {
                isUpdating = true;
                disableButtons();
                const response = await fetch(UPDATE_CART_URL, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json', 'Authorization': AUTH_TOKEN },
                    body: JSON.stringify({ medicine_id: medicineId, quantity: 0 })
                });
                const data = await response.json();
                if (!response.ok) throw new Error(data.message || 'Failed to remove item');
                if (data.success) {
                    await loadCart();
                    showAlert('Item removed from cart!', 'success');
                } else throw new Error(data.message || 'Failed to remove item');
            } catch (error) {
                showAlert(`Failed to remove item: ${error.message}`, 'error');
            } finally {
                isUpdating = false;
            }
        }

        function disableButtons() {
            document.querySelectorAll('.qty-btn, .remove-btn, .checkout-btn').forEach(btn => btn.disabled = true);
        }

        async function proceedToPayment() {
            if (isProcessingPayment) return;
            const address = document.getElementById('deliveryAddress')?.value.trim();
            const name = document.getElementById('customerName')?.value.trim();
            const email = document.getElementById('customerEmail')?.value.trim();
            const phone = document.getElementById('customerPhone')?.value.trim();
            if (!address || !name || !email || !phone) {
                showAlert('Please fill in all required fields', 'error');
                return;
            }
            if (!cartData || !cartData.medicines || cartData.medicines.length === 0) {
                showAlert('Your cart is empty', 'error');
                return;
            }
            try {
                isProcessingPayment = true;
                const checkoutBtn = document.getElementById('checkoutBtn');
                checkoutBtn.disabled = true;
                checkoutBtn.innerHTML = '<span class="btn-loader"></span>CREATING ORDER...';
                const orderData = {
                    amount: cartData.total_amount,
                    currency: 'INR',
                    description: 'Purchase of medicines from TechPharma',
                    cartId: cartData.id || null,
                    deliveryAddress: address,
                    notes: { customerName: name, email: email, phone: phone }
                };
                const orderResponse = await createOrder(orderData);
                if (orderResponse.success) {
                    checkoutBtn.innerHTML = '<span class="btn-loader"></span>OPENING PAYMENT...';
                    initializeRazorpay(orderResponse.data, { name, email, phone });
                } else throw new Error('Failed to create order');
            } catch (error) {
                showAlert(`Payment initialization failed: ${error.message}`, 'error');
                resetCheckoutButton();
                isProcessingPayment = false;
            }
        }

        async function createOrder(orderData) {
            const response = await fetch(CREATE_ORDER_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': AUTH_TOKEN },
                body: JSON.stringify(orderData)
            });
            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.message || 'Failed to create order');
            }
            return await response.json();
        }

        async function verifyPayment(verificationData) {
            const response = await fetch(VERIFY_PAYMENT_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': AUTH_TOKEN },
                body: JSON.stringify(verificationData)
            });
            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.message || 'Payment verification failed');
            }
            return await response.json();
        }

        function initializeRazorpay(orderData, customerInfo) {
            const options = {
                key: orderData.razorpayKeyId,
                amount: orderData.amount * 100,
                currency: orderData.currency,
                name: 'TechPharma',
                description: 'Purchase of medicines',
                order_id: orderData.razorpayOrderId,
                handler: async function (response) {
                    try {
                        showAlert('Verifying payment...', 'success');
                        const verificationData = {
                            orderId: orderData.orderId,
                            razorpayOrderId: response.razorpay_order_id,
                            razorpayPaymentId: response.razorpay_payment_id,
                            razorpaySignature: response.razorpay_signature
                        };
                        const result = await verifyPayment(verificationData);
                        if (result.success) {
                            showPaymentSuccess(result.data);
                        } else {
                            showAlert('Payment verification failed', 'error');
                            resetCheckoutButton();
                        }
                    } catch (error) {
                        showAlert(`Payment verification error: ${error.message}`, 'error');
                        resetCheckoutButton();
                    } finally {
                        isProcessingPayment = false;
                    }
                },
                prefill: {
                    name: customerInfo.name,
                    email: customerInfo.email,
                    contact: customerInfo.phone
                },
                notes: orderData.notes,
                theme: { color: '#2874f0' },
                modal: {
                    ondismiss: function() {
                        showAlert('Payment cancelled by user', 'error');
                        resetCheckoutButton();
                        isProcessingPayment = false;
                    }
                }
            };
            const razorpay = new Razorpay(options);
            razorpay.open();
        }

        function showPaymentSuccess(paymentData) {
            mainContainer.innerHTML = `
                <div class="container" style="grid-template-columns: 1fr; max-width: 600px;">
                    <div class="card">
                        <div class="payment-success">
                            <div class="success-icon">‚úì</div>
                            <h2 class="success-title">Order Placed Successfully!</h2>
                            <p class="success-message">Thank you for your purchase. Your order has been confirmed and will be delivered soon.</p>
                            <div class="payment-info">
                                <div class="info-row">
                                    <span class="info-label">Order ID</span>
                                    <span class="info-value">${paymentData.orderId}</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Payment ID</span>
                                    <span class="info-value">${paymentData.razorpayPaymentId}</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Amount Paid</span>
                                    <span class="info-value">‚Çπ${paymentData.amount}</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Status</span>
                                    <span class="info-value" style="color: #388e3c; text-transform: capitalize;">${paymentData.status}</span>
                                </div>
                                ${paymentData.paymentMethod ? `
                                <div class="info-row">
                                    <span class="info-label">Payment Method</span>
                                    <span class="info-value">${paymentData.paymentMethod}</span>
                                </div>
                                ` : ''}
                            </div>
                            <button class="continue-btn" onclick="window.location.href='index.html'">Continue Shopping</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function resetCheckoutButton() {
            const checkoutBtn = document.getElementById('checkoutBtn');
            if (checkoutBtn) {
                checkoutBtn.disabled = false;
                checkoutBtn.innerHTML = 'PLACE ORDER';
            }
        }

        function formatDate(dateString) {
            if (!dateString) return 'N/A';
            const date = new Date(dateString);
            return date.toLocaleDateString('en-IN', { year: 'numeric', month: 'short' });
        }

        function showLoading() {
            mainContainer.innerHTML = `
                <div class="container" style="grid-template-columns: 1fr;">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        <div>Loading your cart...</div>
                    </div>
                </div>
            `;
        }

        function showAlert(message, type = 'error') {
            const alertClass = type === 'error' ? 'alert-error' : 'alert-success';
            const icon = type === 'error' ? '‚ö†Ô∏è' : '‚úì';
            alertContainer.innerHTML = `
                <div style="max-width: 1200px; margin: 0 auto; padding: 16px 20px 0;">
                    <div class="alert ${alertClass}">
                        <span>${icon}</span>
                        <span>${message}</span>
                    </div>
                </div>
            `;
            setTimeout(() => clearAlerts(), type === 'error' ? 5000 : 3000);
        }

        function clearAlerts() {
            alertContainer.innerHTML = '';
        }

        loadCart();
    </script>
</body>
</html>